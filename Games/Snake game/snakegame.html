<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OurAni</title>
  <link rel="stylesheet" type="text/css" href="snakegame.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <div class="loader"></div>
  <header>
    <a href="../../INDEX.html" class="logo">Our-ani</a>
    <ul>
      <li><a href="../../INDEX.html" class="active">Home</a></li>
      <li><a class="GoBack" href="../../gamespage.html"><i class="fa fa-angle-left" aria-hidden="true"></i></a></li>
    </ul>
  </header>

  <div class="container">
    <div class="game-board-container">
      <p id="game-over">Game Over</p>
    </div>
    <span class="line"></span>
    <div class="btn-container">
      <button class="btn" id="left">Left</button>
      <button class="btn" id="up">Up</button>
      <button class="btn" id="right">Right</button>
      <button class="btn" id="down">Down</button>
    </div>
  </div>

  <p id="score">Score: 0</p>

  <script>
    // Hide loader after page loads
    window.addEventListener("load", () => {
      const loader = document.querySelector(".loader");
      loader.classList.add("loader--hidden");
    });

    // Create canvas for the game
    const gameBoardContainer = document.querySelector('.game-board-container');
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const blockSize = 20;
    const rows = 20; // Rows in the game board
    const cols = 18; // Columns in the game board
    canvas.width = cols * blockSize;
    canvas.height = rows * blockSize;
    gameBoardContainer.appendChild(canvas);

    // Game variables
    const snake = [{ x: 5, y: 8 }, { x: 4, y: 8 }, { x: 3, y: 8 }]; // Initial snake
    let food = { x: 10, y: 10 }; // Initial food position
    let direction = { x: 1, y: 0 }; // Initial direction (moving right)
    let score = 0;

    const scoreElement = document.getElementById("score");
    const gameOverElement = document.getElementById("game-over");

    // Draw a block
    function drawBlock(x, y, color) {
      ctx.fillStyle = color;
      ctx.fillRect(x * blockSize, y * blockSize, blockSize, blockSize);
      ctx.strokeStyle = "black";
      ctx.strokeRect(x * blockSize, y * blockSize, blockSize, blockSize);
    }

    // Draw the game board
    function drawGame() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the snake
      snake.forEach((segment, index) => {
        drawBlock(segment.x, segment.y, index === 0 ? "green" : "lime");
      });

      // Draw the food
      drawBlock(food.x, food.y, "red");
    }

    // Generate random food position
    function placeFood() {
      let newFood;
      do {
        newFood = {
          x: Math.floor(Math.random() * cols),
          y: Math.floor(Math.random() * rows),
        };
      } while (snake.some(segment => segment.x === newFood.x && segment.y === newFood.y));
      food = newFood;
    }

    // Check for collisions
    function checkCollision() {
      const head = snake[0];

      // Check if snake collides with walls
      if (head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows) {
        return true;
      }

      // Check if snake collides with itself
      for (let i = 1; i < snake.length; i++) {
        if (head.x === snake[i].x && head.y === snake[i].y) {
          return true;
        }
      }

      return false;
    }

    // Update the game state
    function updateGame() {
      const head = { x: snake[0].x + direction.x, y: snake[0].y + direction.y };

      // Check if food is eaten
      if (head.x === food.x && head.y === food.y) {
        snake.unshift(head); // Grow the snake
        score++;
        scoreElement.textContent = `Score: ${score}`;
        placeFood();
      } else {
        snake.pop(); // Remove the tail
        snake.unshift(head); // Add new head
      }

      // Check for game over
      if (checkCollision()) {
        gameOver();
      }
    }

    // Game over
    function gameOver() {
      gameOverElement.style.visibility = "visible";
      setTimeout(() => {
        gameOverElement.style.visibility = "hidden";
        resetGame();
      }, 2000);
    }

    // Reset the game
    function resetGame() {
      snake.length = 0;
      snake.push({ x: 5, y: 8 }, { x: 4, y: 8 }, { x: 3, y: 8 });
      direction = { x: 1, y: 0 };
      score = 0;
      scoreElement.textContent = `Score: ${score}`;
      placeFood();
    }

    // Handle button clicks
    document.getElementById("left").addEventListener("click", () => {
      if (direction.x === 0) direction = { x: -1, y: 0 };
    });
    document.getElementById("up").addEventListener("click", () => {
      if (direction.y === 0) direction = { x: 0, y: -1 };
    });
    document.getElementById("right").addEventListener("click", () => {
      if (direction.x === 0) direction = { x: 1, y: 0 };
    });
    document.getElementById("down").addEventListener("click", () => {
      if (direction.y === 0) direction = { x: 0, y: 1 };
    });

    // Game loop
    function gameLoop() {
      updateGame();
      drawGame();
      setTimeout(gameLoop, 100);
    }

    resetGame();
    gameLoop();
  </script>
</body>
</html>
